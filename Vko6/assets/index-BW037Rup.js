import{r as p,j as a,a as y}from"./react-DN4kTZAy.js";import{c as b}from"./react-dom-Cuys_zfA.js";import{a as x}from"./axios-Cm0UX6qg.js";import"./firebase-DPbAWnEQ.js";import{i as v,g as j,a as w,b as _,c as S}from"./@firebase-Dl2OLgbF.js";import{B as d,T as u,F as D,S as I,M as C,D as O,a as N}from"./@mui-Dg-288wS.js";import"./@babel-D81kMKJT.js";import"./scheduler-CzFDRTuY.js";import"./idb-BXWtuYvb.js";import"./tslib-BGVaTf34.js";import"./clsx-B-dksMZM.js";import"./prop-types-DE3CWkU5.js";import"./@emotion-DmTzejm2.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-NkKAe6Bn.js";import"./reselect-HBGHfvfV.js";import"./react-is-DcfIKM1A.js";import"./react-transition-group-DOt8SPoL.js";import"./@popperjs-BQBsAJpH.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&l(n)}).observe(document,{childList:!0,subtree:!0});function s(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(e){if(e.ep)return;e.ep=!0;const r=s(e);fetch(e.href,r)}})();const k={apiKey:"AIzaSyCqXSUGGtitCjDX01x5HreMPYQy7Gv20LE",authDomain:"pilvi-react-6210b.firebaseapp.com",projectId:"pilvi-react-6210b",storageBucket:"pilvi-react-6210b.appspot.com",messagingSenderId:"250062694540",appId:"1:250062694540:web:d22c1400c4a36c246633a9"},f=v(k),A=j(f);w(f);function P(){const[c,o]=p.useState({}),[s,l]=p.useState(30),e=[{label:"1 week",days:7},{label:"2 weeks",days:14},{label:"3 weeks",days:21},{label:"4 weeks",days:28},{label:"1 month",days:30},{label:"2 months",days:60},{label:"3 months",days:90}];p.useEffect(()=>{(async()=>{try{const t=await x.get(`https://pilvipalvelut-matomo.rahtiapp.fi/index.php?module=API&method=VisitsSummary.get&idSite=17&period=day&date=last${s}&format=json&token_auth=913021d386d2651bbd7e26d104f3e78c`);if(t.status===200){const g=await t.data;o(g)}}catch(t){console.error("Virhe tietojen haussa: ",t)}})()},[s]);const r=i=>{l(i.target.value)},n=async()=>{try{for(const i of m){const t=await _(S(A,"TrackingData"),i);console.log("Uusi Json lisätty ID= ",t.id)}}catch(i){console.error("Virhe Firestoreen tallennuksessa: ",i)}},h=[{field:"date",headerName:"Date",width:150},{field:"nb_visits",headerName:"Visits",width:150},{field:"nb_uniq_visitors",headerName:"Unique visitors",width:200},{field:"nb_actions",headerName:"Actions",width:150},{field:"sum_visit_length",headerName:"Total time spent",width:200},{field:"bounce_rate",headerName:"Bounce rate",width:150}],m=Object.keys(c).filter(i=>{const t=c[i];return typeof t=="object"&&Object.keys(t).length>0}).map(i=>{const t=c[i];return{id:i,date:i,nb_visits:t.nb_visits,nb_uniq_visitors:t.nb_uniq_visitors,nb_actions:t.nb_actions,sum_visit_length:t.sum_visit_length+" sec",bounce_rate:t.bounce_rate}});return a.jsx(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",margin:"auto"},children:a.jsxs(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"90vw",height:"90vh",marginTop:5},children:[a.jsx(u,{variant:"h2",paragraph:!0,children:"Tracking data"}),a.jsxs(d,{sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},children:[a.jsx(u,{variant:"h6",children:"Select period  "}),a.jsx(D,{margin:"normal",children:a.jsx(I,{name:"period",value:s,onChange:r,children:e.map((i,t)=>a.jsx(C,{value:i.days,children:i.label},t))})})]}),a.jsxs(d,{style:{width:"80%",maxWidth:"80%",flexGrow:1},children:[a.jsx(O,{autoHeight:!0,rows:m,columns:h,initialState:{pagination:{paginationModel:{pageSize:5}}},pageSizeOptions:[5,10],disableRowSelectionOnClick:!0}),a.jsx(N,{sx:{margin:1},variant:"outlined",onClick:n,children:"Save to database"})]})]})})}b.createRoot(document.getElementById("root")).render(a.jsx(y.StrictMode,{children:a.jsx(P,{})}));
